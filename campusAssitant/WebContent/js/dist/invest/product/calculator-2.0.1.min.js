define(["jquery","common"],function(r,s){var e=function(s,e,a){var l=!0;if(!s||""===r.trim(s))return r("#zzu_error").html("请填写金额"),l=!1,r("#zzu_calc_je").addClass("zzu-error-input"),l;if(r("#zzu_calc_je").removeClass("zzu-error-input"),!e||""===r.trim(e))return r("#zzu_error").html("请填写利率"),l=!1,r("#zzu_calc_nhlv").addClass("zzu-error-input"),l;if(r("#zzu_calc_nhlv").removeClass("zzu-error-input"),!a||""===r.trim(a))return r("#zzu_error").html("请填写期数"),l=!1,r("#zzu_calc_qs").addClass("zzu-error-input"),l;r("#zzu_calc_qs").removeClass("zzu-error-input");var t=/^\d+\.?\d{0,2}$/;if(isNaN(s)||!t.test(s)||parseFloat(s)<=0)return r("#zzu_error").html("金额必须大于０并且只有２位小数"),l=!1,r("#zzu_calc_je").addClass("zzu-error-input"),l;if(r("#zzu_calc_je").removeClass("zzu-error-input"),isNaN(e)||!t.test(e)||parseFloat(e)<=0)return r("#zzu_error").html("利率必须大于0并只能有两位小数"),l=!1,r("#zzu_calc_nhlv").addClass("zzu-error-input"),l;r("#zzu_calc_nhlv").removeClass("zzu-error-input");var c=/^\d{1,3}$/;return isNaN(a)||!c.test(a)?(r("#zzu_error").html("期数必须是1-999正整数"),l=!1,r("#zzu_calc_qs").addClass("zzu-error-input"),l):(r("#zzu_calc_qs").removeClass("zzu-error-input"),r("#zzu_error").html(""),l)},a=function(){var a=r("#zzu_calc_je").val(),l=r("#zzu_calc_nhlv").val(),t=r("#zzu_calc_qs").val();if(r("#zzu_calc_je,#zzu_calc_nhlv,#zzu_calc_qs").bind("blur",function(){e(r("#zzu_calc_je").val(),r("#zzu_calc_nhlv").val(),r("#zzu_calc_qs").val())}),e(a,l,t)){r("#zzu_calc_table tr[id=zzu_calc_result]:visible").remove();for(var c=new Number(l/100/12),a=new Number(a).toFixed(2),_=0,w=0,j=a*c*Math.pow(1+c,t)/(Math.pow(1+c,t)-1),n=a,i=new Array(parseInt(t)),o=0,m=0;m<i.length;m++){n-=_,w=n*c,_=j-w;var u={};u.index=m+1,u.surplus=s.retainTwoDecimal(n),u.capital=s.retainTwoDecimal(_),u.interest=s.retainTwoDecimal(w),u.sum=s.retainTwoDecimal(j),i[m]=u,o+=parseFloat(u.interest)}s.putTemplete("zzu_calculator_stage",i,"zzu_calculator_tbody"),r("#zzu_calc_investment_amount").empty().html(a),r("#zzu_calc_interest").empty().html(s.retainTwoDecimal(o)),r("#zzu_calc_monthly_sum").empty().html(s.retainTwoDecimal(j)),r("#zzu_calc_months").empty().html(t)}};r("#zzu_calc_star").on("click",a)});