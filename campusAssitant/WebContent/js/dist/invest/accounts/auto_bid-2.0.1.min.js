define(["jquery","common","util/validate","accountsPublic"],function(e,t,n){function s(){var s=e("#zzu_exphasis_textBox").val();if(!n.checkMoney(s)&&0>s)return void e(".zzu-error-info").html("请输入合法金额");e(".zzu-error-info").hide();var a={retentionAmount:s},i=function(n){if("1111"==n.code){var a=t.formatMoney(s,2);e("#zzu_text_emphasis").show(),e("#zzu_exphasis_textBox").hide(),e("#zzu_text_emphasis").html(a),e(".zzu-btn-text").html("修改").attr("data-type","update")}};t.ajaxUtil("autotender/updateremention.json",a,"POST",i)}e(".zzu-operate").click(function(){e("#zzu_text_emphasis").hide(),e("#zzu_exphasis_textBox").show()});var a=function(n){if(n){var s=[];e(n.rules).each(function(e,t){if(0==e){var n={deadline:"少于1个月",earnings:9+e+"%-"+(9+e+1)+"%",repayment:"一次性还本付息",money:t.INVEST_AMT_MIN+"-"+t.INVEST_AMT_MAX,ranking:t.ranking,investment:t.TOTAL_INVEST,maximum:t.MOST_INVEST,status:t.STATUS,ruleId:t.RULE_ID};s.push(n)}else if(3==e){var n={deadline:"7个月以上",earnings:"15%以上",repayment:"等额本息",money:t.INVEST_AMT_MIN+"-"+t.INVEST_AMT_MAX,ranking:t.ranking,investment:t.TOTAL_INVEST,maximum:t.MOST_INVEST,status:t.STATUS,ruleId:t.RULE_ID};s.push(n)}else{var n={deadline:e+3*(e-1)+"-"+(e+1+3*(e-1))+"个月",earnings:9+2*e+"%-"+(9+2*e+1)+"%",repayment:"等额本息",money:t.INVEST_AMT_MIN+"-"+t.INVEST_AMT_MAX,ranking:t.ranking,investment:t.TOTAL_INVEST,maximum:t.MOST_INVEST,status:t.STATUS,ruleId:t.RULE_ID};s.push(n)}})}n.avail&&e("#zzu_cash_current").html(n.avail),n.retentionAmount&&(e("#zzu_text_emphasis").html(n.retentionAmount),e("#zzu_exphasis_textBox").val(n.retentionAmount)),n.investAchievement.total_investment&&e("#zzu_cash_amount").html(n.investAchievement.total_investment),n.investAchievement.total_profit&&e("#zzu_cash_earn").html(n.investAchievement.total_profit),n.investAchievement.invest_num&&e("#zzu_cash_times").html(n.investAchievement.invest_num),t.putTemplete("zzu_bid_plan_tem",s,"zzu_bid_plan")};t.ajaxUtil("autotender/getrules.json",{},"GET",a),e("#zzu_exphasis_textBox").hide(),e(".zzu-operate").click(function(){var t=e(".zzu-btn-text").attr("data-type");"update"==t?(e("#zzu_text_emphasis").hide(),e("#zzu_exphasis_textBox").show(),e(".zzu-btn-text").html("保存").attr("data-type","save")):s()})});