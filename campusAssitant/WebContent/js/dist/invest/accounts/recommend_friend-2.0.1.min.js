define(["jquery","common","lib/qrcode.min","util/validate","accountsPublic","page"],function(e,t,a,o,s){function n(a,o){var s=a||1,c=o||8,i=(s-1)*c,r=c,m={start:i,length:r,columns:[{data:"tel",name:"tel"},{data:"time",name:"time"},{data:"usr_custid",name:"usr_custid"},{data:"bonus",name:"bonus"},{data:"STATE",name:"STATE"}],order:[{column:"1",dir:"desc"}]};t.ajaxUtil("recommendFriend/recommendList.json",{pageData:JSON.stringify(m)},"POST",function(a){t.putTemplete("zzu_recommend_people_tem",a.data,"zzu_recommend_people"),e.zzuPage({pageId:"pageContainer",pageNo:s,pageSize:c,totalCount:a.recordsFiltered,load:n})})}var c,i,r=t.getItemSession("recommend");o.isNotNull(r)?(c=BaseUrl+"/mobile/views/activity/redPacket/red_Packet.html?recommend="+r,i=BaseUrl+"/register.html?recommend="+r,e("#zzu_recommend_url").html("<a href="+c+">查看详情</a>"),e("#zzu_recommend_code_pc").html(i)):t.ajaxUtil("recommendFriend/getRecommendCode.json",null,"GET",function(t){t.recommendCode&&(r=t.recommendCode),c=BaseUrl+"/mobile/views/activity/redPacket/red_Packet.html?recommend="+r,i=BaseUrl+"/register.html?recommend="+r,e("#zzu_recommend_url").html("<a href="+c+">查看详情</a>"),e("#zzu_recommend_code_pc").html(i)}),e(".zzu-copy").on("click",function(){t.copyUrl(i)}),t.ajaxUtil("recommendFriend/getRecommendInfo.json",null,"GET",function(t){t.cashAmount&&e("#zzu_cash_amount").html(t.cashAmount),t.bonus&&e("#zzu_bonus").html(t.bonus),t.regCount&&e("#zzu_reg_count").html(t.regCount),t.investReg&&e("#zzu_invest_reg").html(t.investReg)}),n(),e("#zzu_weibo_share").on("click",function(){i&&window.open("http://service.weibo.com/share/share.php?title=用我的推荐码注册，可得10000元体验金，登录"+i+"参加活动吧。&pic=http://www.zzuchina.com/images/nv_logo.png")}),e(document).on("click",function(){e("#zzu_show_error").html(""),e("#zzu_sms_share,#zzu_weixin_share").removeClass("active")});var a=new QRCode(document.getElementById("qrcode"),{width:137,height:137}),m=function(){a.makeCode(c)};e("#zzu_weixin_share").on("click",m),e("#zzu_captcha_img").on("click",function(){e(this).attr("src","/i/n/images/captcha.jpg?"+Math.random())}),e("#zzu_captcha_img").trigger("click"),e("#zzu_sms_share,#zzu_weixin_share").on("click",function(t){e(this).addClass("active").siblings().removeClass("active"),t.stopPropagation()}),e("#zzu_btn_confirm").on("click",function(){var a=e("#zzu_share_phone").val(),s=e("#zzu_vat").val();return o.isPhoneNumber(a)?o.isNotNull(s)?void t.ajaxUtil("n/captcha/check.json",{captcha:s},"POST",function(o){"1111"==o.code?t.ajaxUtil("recommendFriend/sharemessage.json",{tel:a,vat:s},"POST",function(t){t.message&&(e("#zzu_show_error").html(t.message),e("#zzu_share_phone").val(""),e("#zzu_vat").val(""),e("#zzu_captcha_img").trigger("click"))}):(e("#zzu_vat").val(""),e("#zzu_captcha_img").trigger("click"),e("#zzu_show_error").html(o.message))}):(e("#zzu_vat").focus(),e("#zzu_captcha_img").trigger("click"),void e("#zzu_show_error").html("图形验证码不能为空")):(e("#zzu_share_phone").val("").focus(),e("#zzu_captcha_img").trigger("click"),void e("#zzu_show_error").html("手机号格式不正确"))})});